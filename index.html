<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NWM | Front Desk Master Simulator v4.5</title>
    <!-- Tailwind CSS for Styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel for Browser Execution -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap');
        body { font-family: 'Inter', sans-serif; overflow-x: hidden; }
        .animate-in { animation: fadeIn 0.4s ease-out; }
        .animate-pop { animation: popIn 0.3s cubic-bezier(0.26, 0.53, 0.74, 1.48); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes popIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        .aspect-video { aspect-ratio: 16 / 9; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const Icon = ({ name, size = 20, className = "" }) => {
            useEffect(() => { if (window.lucide) window.lucide.createIcons(); }, [name]);
            return <i data-lucide={name} style={{ width: size, height: size }} className={className}></i>;
        };

        const App = () => {
            const [stage, setStage] = useState('intro');
            const [score, setScore] = useState(0);
            const [feedback, setFeedback] = useState(null);
            const [showVideo, setShowVideo] = useState(false);
            const [sessionSeed, setSessionSeed] = useState(0);

            // --- NWM VIDEO EMBED URL ---
            const EMBED_URL = "https://www.youtube.com/embed/9CdTtFxzWNA"; 

            // Helper to shuffle options for variability
            const shuffle = (array) => {
                let currentIndex = array.length, randomIndex;
                while (currentIndex != 0) {
                    randomIndex = Math.floor(Math.random() * currentIndex);
                    currentIndex--;
                    [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
                }
                return array;
            };

            const stagesPool = useMemo(() => ({
                intro: {
                    title: "Front Desk Training Portal",
                    subtitle: "New West Music Internal Training",
                    content: "A warm first greeting makes families feel welcome and valued—building trust and easing first-lesson nerves. Today, you'll play as the front desk staff managing a demo lesson for a new student, Sam. Master the flow from 'Presence' to the final 'Folder color picking'.",
                    options: [
                        { text: "Watch Demo Greeting Video", action: () => setShowVideo(true), isVideo: true },
                        { text: "Start Training Session", action: () => setStage('prep') }
                    ]
                },
                prep: {
                    title: "Module 1: Pause & Be Present",
                    subtitle: "3:55 PM Preparation",
                    content: "Sam's demo is in 5 minutes. You are currently handling a few office tasks. What is the standard NWM protocol to prepare for their arrival?",
                    options: shuffle([
                        { text: "Stop other office tasks to be available and fully present, check Google Calendar for Sam's info and prepare a few available times for weekly lessons in advance.", points: 25, nextStage: 'greeting', feedback: "Excellent. Pausing your tasks ensure you are mentally ready and available to receive the family the moment they walk in." },
                        { text: "Continue finishing the current task so Sam doesn't see you idle, but keep the Google Calendar open just in case.", points: 5, nextStage: 'greeting', feedback: "Incorrect. Our goal is full availability. You shouldn't be 'finishing up' when a new family arrives—you should be waiting for them." }
                    ])
                },
                greeting: {
                    title: "Module 2: The Greeting",
                    subtitle: "First Impressions",
                    content: "Sam and his Dad walk through the door. Sam looks nervous. How do you handle the first 10 seconds?",
                    options: shuffle([
                        { text: "Stand up, and say: 'Hi! You must be Sam and Mr. Smith! Welcome to NWM, we’ve been expecting you.'", points: 25, nextStage: 'rapport', feedback: "Perfect. Addressing them by name and standing up immediately builds safety and trust." },
                        { text: "Wave and smile from your chair: 'Hi there! Are you Sam? Your teacher will be out in just a few minutes.'", points: 10, nextStage: 'rapport', feedback: "Passive. Rule Check: Always stand up. They should feel 'Expected', not just 'Processed'." }
                    ])
                },
                rapport: {
                    title: "Module 3: Rapport Rituals",
                    subtitle: "The Fun Gesture",
                    content: "You have 2 minutes before the teacher arrives. How do you use the 'Sticker Rule' to connect with Sam?",
                    options: shuffle([
                        { text: "Offer Sam a welcome sticker and ask: 'Sam, do you have a favorite song or artist you'd love to learn on guitar?'", points: 25, nextStage: 'education', feedback: "Great work. The sticker breaks the ice, and the question helps Sam focus on the fun of music." },
                        { text: "Invite Sam to have a seat and ask Mr. Smith if they found the parking okay.", points: 5, nextStage: 'education', feedback: "Missed rapport opportunity. Use the 'Sticker Gesture' specifically to help the student feel at ease." }
                    ])
                },
                education: {
                    title: "Module 4: Educational Viewpoint",
                    subtitle: "Methodology Explanation",
                    content: "Mr. Smith asks: 'How do you actually teach here? Is Sam just going to play games?' How do you explain our methodology?",
                    options: shuffle([
                        { text: "Explain our methodology is organized by levels; Sam will progress step-by-step each week while building practice habits at home.", points: 30, nextStage: 'post_demo', feedback: "Masterful. Parents value hearing about graded levels and weekly progress habits." },
                        { text: "Explain that our teachers are professionals who will make sure Sam has fun and gets to pick his own music.", points: 15, nextStage: 'post_demo', feedback: "Too vague. Emphasize the graded levels system and the commitment to weekly progress." }
                    ])
                },
                post_demo: {
                    title: "Module 5: Post-Demo Connection",
                    subtitle: "Emotion First",
                    content: "Sam runs out beaming. Dad follows. What is your signature power question?",
                    options: shuffle([
                        { text: "Welcome back! Sam, how did it feel? Did you have fun in there?", points: 30, nextStage: 'value_add', feedback: "Perfect. We always validate the emotional experience before discussing the calendar or price." },
                        { text: "Great job, Sam! Mr. Smith, ready to sign him up for that Tuesday spot in Google Calendar?", points: 10, nextStage: 'value_add', feedback: "Too fast. Always ask 'How did it feel?' first." }
                    ])
                },
                value_add: {
                    title: "Module 6: Building Community",
                    subtitle: "Recitals & Rewards",
                    content: "Dad asks what the experience is like at New West Music long-term.",
                    options: shuffle([
                        { text: "Mention our 3 annual recitals and our sticker chart reward system where Sam earns tokens for small prizes.", points: 30, nextStage: 'showroom', feedback: "Exactly. 3 recitals per year and tangible prizes for practice are major NWM value-add touchpoints." },
                        { text: "Mention we have 2 recitals and that students get a certificate when they finish a book.", points: 15, nextStage: 'showroom', feedback: "Close, but remember we host 3 recitals a year and use sticker charts for actual rewards!" }
                    ])
                },
                showroom: {
                    title: "Module 7: Solving Barriers",
                    subtitle: "The Showroom Advantage",
                    content: "Dad mentions: 'He loved it, but we don't have a guitar. I'm worried about the cost if he stops.'",
                    options: shuffle([
                        { text: "Mention our showroom with affordable rentals and beginner instruments for sale. This lets Sam try it at home with minimal risk.", points: 25, nextStage: 'scheduling', feedback: "Correct. Highlighting our showroom rentals removes the equipment barrier instantly." },
                        { text: "Tell him Sam can borrow our guitars here for every lesson until you're sure he wants to continue.", points: 10, nextStage: 'scheduling', feedback: "Vague. Sam needs an instrument at home for weekly practice. Always suggest a rental solution." }
                    ])
                },
                scheduling: {
                    title: "Module 8: The Close",
                    subtitle: "Assumptive Scheduling",
                    content: "Dad is ready. How do you present the time options you prepped earlier from Google Calendar?",
                    options: shuffle([
                        { text: "I have Tuesdays at 4:00 or Thursdays at 5:00 held for Sam. Which is easier for you? (Then stay silent).", points: 35, nextStage: 'registration', feedback: "Masterful. Specific options + Silence = Confident Enrollment." },
                        { text: "Let's check the Google Calendar now. What days usually work best for your commute?", points: 10, nextStage: 'registration', feedback: "Passive. Lead with the options you prepped earlier to make the decision easy for them." }
                    ])
                },
                registration: {
                    title: "Module 9: Final Registration",
                    subtitle: "QR Code & Welcome Folder",
                    content: "The time is confirmed! How do you guide them through the registration and the folder ritual?",
                    options: shuffle([
                        { text: "Direct Mr. Smith to the QR code to register on his own device while you let Sam pick out his favorite folder color.", points: 30, nextStage: 'logistics', feedback: "Masterful. This keeps the parent engaged with the form while creating a 'fun' moment for the student." },
                        { text: "Tell Mr. Smith you will email him the form and give Sam a random folder to save time.", points: 5, nextStage: 'logistics', feedback: "Inefficient. Always aim for registration on-site via QR and let the child pick their color to build ownership." }
                    ])
                },
                logistics: {
                    title: "Module 10: Final Transparency",
                    subtitle: "Billing & Policy",
                    content: "How do you explain the billing and the 'pause' policy?",
                    options: shuffle([
                        { text: "Lessons are $33/class, billed monthly. You can pause anytime with 30-day notice.", points: 30, nextStage: 'summary', feedback: "Perfect. Transparency on price and the pause policy builds long-term trust." },
                        { text: "It's billed monthly automatically. Our full policy is on the website.", points: 15, nextStage: 'summary', feedback: "Always mention the $33 rate and the 30-day notice explicitly during the enrollment." }
                    ])
                }
            }), [sessionSeed]);

            const handleOptionClick = (option) => {
                if (option.action) {
                    option.action();
                } else {
                    setScore(s => s + (option.points || 0));
                    setFeedback(option.feedback);
                    setStage(option.nextStage);
                }
            };

            const reset = () => {
                setStage('intro');
                setScore(0);
                setFeedback(null);
                setSessionSeed(s => s + 1);
            };

            if (stage === 'summary') {
                const percentage = Math.round((score / 315) * 100); 
                const grade = percentage > 90 ? "Maestro" : percentage > 70 ? "Coordinator" : "Trainee";
                return (
                    <div className="min-h-screen flex items-center justify-center p-6 text-center animate-in">
                        <div className="max-w-md w-full bg-white rounded-[3rem] shadow-2xl p-12 border border-slate-100">
                            <div className="w-24 h-24 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-8 text-orange-600">
                                <Icon name="award" size={48} className="fill-orange-600" />
                            </div>
                            <h1 className="text-4xl font-black text-slate-900 mb-2 tracking-tighter">Mastery: {percentage}%</h1>
                            <p className="text-slate-400 font-bold uppercase tracking-widest text-[10px] mb-8">{grade} Certification</p>
                            <div className="bg-slate-50 rounded-3xl p-8 mb-10 text-left border border-slate-100">
                                <p className="text-sm text-slate-600 leading-relaxed font-medium">
                                    Excellent work! You successfully practiced **Presence**, referenced **Google Calendar**, and mastered our **QR Code Registration** process!
                                </p>
                            </div>
                            <button onClick={reset} className="w-full py-5 bg-slate-900 text-white rounded-2xl font-black shadow-lg hover:bg-orange-600 transition-all flex items-center justify-center gap-2">
                                <Icon name="rotate-ccw" size={18} /> New Training Shift
                            </button>
                        </div>
                    </div>
                );
            }

            const current = stagesPool[stage];

            return (
                <div className="min-h-screen flex items-center justify-center p-6 relative">
                    {/* Video Modal Overlay */}
                    {showVideo && (
                        <div className="fixed inset-0 z-50 bg-slate-900/95 flex items-center justify-center p-4 backdrop-blur-sm">
                            <div className="max-w-4xl w-full bg-black rounded-3xl overflow-hidden shadow-2xl animate-pop border border-slate-700">
                                <div className="flex justify-between items-center p-4 bg-slate-800 text-white">
                                    <span className="font-black text-xs uppercase tracking-widest text-orange-400">NWM Masterclass</span>
                                    <button onClick={() => setShowVideo(false)} className="hover:text-orange-500 transition-colors">
                                        <Icon name="x" size={24} />
                                    </button>
                                </div>
                                <div className="aspect-video w-full bg-slate-900">
                                    <iframe 
                                        src={EMBED_URL} 
                                        className="w-full h-full" 
                                        frameBorder="0" 
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                        allowFullScreen
                                    ></iframe>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Simulation Card */}
                    <div className="max-w-md w-full bg-white rounded-[3rem] shadow-2xl overflow-hidden animate-in border border-slate-100 flex flex-col min-h-[820px]">
                        <div className="bg-slate-900 px-10 py-5 flex items-center justify-between">
                            <div className="flex items-center gap-2">
                                <Icon name="music" size={14} className="text-orange-500" />
                                <span className="text-white font-black text-[9px] uppercase tracking-[0.3em]">NWM Master Simulator v4.5</span>
                            </div>
                        </div>

                        <div className="p-10 flex-grow">
                            {stage !== 'intro' && (
                                <div className="mb-10">
                                    <div className="flex justify-between mb-2">
                                        <span className="text-[10px] font-black uppercase text-slate-400 tracking-widest italic tracking-tighter">Conversion Confidence</span>
                                        <span className="text-[10px] font-black text-orange-600">{Math.min(Math.round((score/315)*100), 100)}%</span>
                                    </div>
                                    <div className="w-full bg-slate-100 h-1.5 rounded-full overflow-hidden shadow-inner">
                                        <div className="bg-orange-500 h-full transition-all duration-1000" style={{width: `${(score/315)*100}%`}}></div>
                                    </div>
                                </div>
                            )}

                            <h1 className="text-3xl font-black text-slate-900 leading-[1.1] mb-1 tracking-tighter">{current.title}</h1>
                            <p className="text-orange-600 font-black text-[10px] uppercase tracking-[0.2em] mb-10">{current.subtitle}</p>

                            {feedback && (
                                <div className={`mb-10 p-6 rounded-[2.5rem] border-2 flex gap-4 animate-in ${feedback.includes('Incorrect') || feedback.includes('Passive') || feedback.includes('Vague') ? 'bg-rose-50 border-rose-100 text-rose-900' : 'bg-emerald-50 border-emerald-100 text-emerald-900'}`}>
                                    <Icon name={feedback.includes('Correct') || feedback.includes('Perfect') || feedback.includes('Masterful') || feedback.includes('Excellent') ? "check-circle" : "alert-circle"} size={20} className="shrink-0 mt-0.5" />
                                    <p className="text-sm font-bold leading-snug italic leading-tight">{feedback}</p>
                                </div>
                            )}

                            <p className="text-slate-600 text-lg font-medium leading-relaxed mb-12 tracking-tight">{current.content}</p>

                            <div className="space-y-4">
                                {current.options.map((opt, i) => (
                                    <button 
                                        key={i} 
                                        onClick={() => handleOptionClick(opt)} 
                                        className={`w-full text-left p-6 rounded-[2.2rem] border-2 transition-all group flex items-center justify-between gap-4 shadow-sm hover:scale-[1.01] ${opt.isVideo ? 'bg-orange-500 border-orange-500 text-white hover:bg-orange-600' : 'bg-slate-50 border-transparent hover:border-slate-900 hover:bg-white'}`}
                                    >
                                        <span className="font-black leading-tight tracking-tight">{opt.text}</span>
                                        <Icon name={opt.isVideo ? "play" : "chevron-right"} size={18} className={opt.isVideo ? "text-white fill-white" : "text-slate-300 group-hover:text-slate-900"} />
                                    </button>
                                ))}
                            </div>
                        </div>

                        <div className="p-10 pt-0 mt-auto opacity-20 text-[8px] font-black uppercase tracking-[0.4em] flex justify-between italic text-center">
                            <span>New West Music Master Simulator v4.5</span>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
